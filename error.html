<!DOCTYPE html>
<html lang="en">
  <head>
    <title>Error!</title>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    
    <!-- import the webpage's stylesheet -->
    <style>
      body {
      font-family: -apple-system,BlinkMacSystemFont,"Segoe UI",system-ui,Roboto,Oxygen-Sans,Ubuntu,Cantarell,"Helvetica Neue",sans-serif;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      text-align: center;
    }

    h1 {
      font-size: 34px;
      color: #000;
      letter-spacing: -.82px;
    }

    h2 {
      font-weight: 500;
    }
  
    a {
      color: #0169d9;
      text-decoration: none;
    }
  
    button,.button,[type="button"],[type="submit"],[type="reset"] {
      display:block;
      cursor: pointer;
      font-weight: 500;
      font:inherit;
      border:none;
      background: #0169d9;
      color: #fff;
      width:90vw;
      max-width: 200px;
      text-decoration: none;
      padding: 10px;
      margin: 1em auto;
      border-radius: 8px;
      text-align: center;
    }
  
    #notinstalled, #error {
      display:none;
    }
    #notinstalled:target, #error:target {
      display:flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }
  </style>
  </head>
  <body>
    <div id="notinstalled">
    <h2>This site requires a <a href="https://support.apple.com/en-au/guide/shortcuts/apdf22b0444c/2.2/ios/12.0">Shortcut</a> called</h2>
    <h1 class="name"></h1>
    <a id="link" class="button" >Get Shortcut</a>
    </div>
    <div id="error">
      <h1>
        Oops!
      </h1>
      <p>There was an error while running "<span class="name"></span>"</p>
      <code class="error"></code>
      
      
    </div>

    <script>
       var params = new URLSearchParams(window.location.search);
       var sname = params.get("name");
       var link = params.get("uri");
       var error = params.get("errorMessage");
       document.querySelector("#link").href=link;
       document.querySelectorAll(".name").forEach(n=>n.textContent=sname);
       document.querySelectorAll(".error").forEach(n=>n.textContent=error);
       if (error === null) {
          window.location="#notinstalled";
        } else if (error.match(/not.*?find.*?shortcut/i)) {
           window.location="#notinstalled";
         } else {
           window.location="#error";
         };
    </script>
  </body>
</html>